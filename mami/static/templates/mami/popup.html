<style>
    .ol-popup {
        position: absolute;
        background-color: white;
        box-shadow: 0 1px 4px rgba(0, 0, 0, 0.2);
        padding: 15px;
        border-radius: 10px;
        border: 1px solid #cccccc;
        bottom: 12px;
        left: -50px;
        min-width: 280px;
    }
    
    .ol-popup:after,
    .ol-popup:before {
        top: 100%;
        border: solid transparent;
        content: " ";
        height: 0;
        width: 0;
        position: absolute;
        pointer-events: none;
    }
    
    .ol-popup:after {
        border-top-color: white;
        border-width: 10px;
        left: 48px;
        margin-left: -10px;
    }
    
    .ol-popup:before {
        border-top-color: #cccccc;
        border-width: 11px;
        left: 48px;
        margin-left: -11px;
    }
    
    .ol-popup-closer {
        text-decoration: none;
        position: absolute;
        top: 2px;
        right: 8px;
    }
    
    .ol-popup-closer:after {
        content: "X";
    }
</style>

<script>
    /**
     * Elements that make up the popup.
     */
    var container = document.getElementById('popup');
    var content = document.getElementById('popup-content');
    var closer = document.getElementById('popup-closer');

    /* create a text as content for a popup
     */
    var popupText = '';

    /**
     * Create an overlay to anchor the popup to the map.
     */
    var millInfo = new ol.Overlay({
        element: container,
        autoPan: true,
        autoPanAnimation: {
            duration: 250
        }
    });


    /**
     * Add a click handler to hide the popup.
     * @return {boolean} Don't follow the href.
     */
    closer.onclick = function() {
        millInfo.setPosition(undefined);
        closer.blur();
        return false;
    };

    function popup(e) {

        if (navigator.onLine) {
            // internet connection available so no imagemap needed
            document.getElementById("imagemap").style.display = "none";
            map.addOverlay(millInfo);
        } else {
            imagemap.addOverlay(millInfo);
        }

        // Clear previous popup (if exists)
        millInfo.setPosition(undefined);
        closer.blur();

        // Make new popup
        console.log(e);
        if (e.selected.length > 0) {
            selectedFeature = e.selected[e.selected.length - 1];
            selectedId = selectedFeature.getId();

            var coordinate = selectedFeature.values_.geometry.flatCoordinates;
            millInfo.setPosition(coordinate);

            content.innerHTML = "<div id=\"popup_" + selectedId + "\">" + selectedFeature.values_.name + "</div>";
            if (selectedId != undefined) {
                $.getJSON("getDataAsJSON/?feature_id=" + selectedId)
                    .done(function(data) {
                        var popupText = "<ul>";
                        console.log(data);
                        $.each(data, function(key, val) {
                            popupText += "<li id=\"popup_" + key + "\">" + val + "</li>\n";
                            console.log(popupText);

                        });
                        popupText += "</ul>";
                        content.innerHTML += popupText; //'<p>You clicked here:</p><code>' + hdms + '</code>';
                    })
            };
        }
    }
</script>